---
import Icon from './Icon.astro';
---

<script>
  import { gsap } from "gsap";
  
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        if (window.innerWidth < 1500) {
          let tl1 = gsap.timeline({
            scrollTrigger: {
              trigger: ".experiences",
              start: "center 50%",
              end: "bottom bottom",
              scrub: false,
              markers: true,
              toggleActions: 'play reverse play reverse'
            }
          });
          tl1.to(".timeline-item", {
            y: 0,
            opacity: 1,
            duration: 0.5,
            stagger: 0.2
          });
        } else {
          let tl2 = gsap.timeline({
            scrollTrigger: {
              trigger: ".experiences",
              start: "center 50%",
              end: "bottom bottom",
              scrub: false,
              markers: true,
              toggleActions: 'play reverse play reverse'
            }
          });
          tl2.to(".timeline-item", {
            x: 0,
            opacity: 1,
            duration: 0.5,
            stagger: 0.2
          });
        }
      }
    });
  });
  
  observer.observe(document.querySelector('.experiences'));
</script>

<section class="box experiences">
    <div class="title-container">
        <Icon icon="pencil-line" color="var(--accent-regular)" size="2.5rem" gradient />
        <h3 class="Experience">Experiences:</h3>
    </div>
    
    <div class="timeline">
        <div class="timeline-item">
            <div class="timeline-point"></div>
            <div class="timeline-content stack gap-2 lg:gap-4">
                <h5>Churkin Moscow International Model United Nations (C-MIMUN) 2022</h5>
                <p>Representative of the African Asian Legal Consultative Organization (AALCO) at the Security Council (SC)</p>
            </div>
        </div>
        
        <div class="timeline-item">
            <div class="timeline-point"></div>
            <div class="timeline-content stack gap-2 lg:gap-4">
                <h5>Churkin Moscow International Model United Nations (C-MIMUN) 2021</h5>
                <p>Representative of Italy at the Human Rights Council (HRC)</p>
            </div>
        </div>
        
        <div class="timeline-item">
            <div class="timeline-point"></div>
            <div class="timeline-content stack gap-2 lg:gap-4">
                <h5>Junior Departmental Councilor in Dordogne 2016/2018</h5>
            </div>
        </div>
    </div>
</section>

<style>
  .box {
    margin-bottom: 30dvh;
    position: relative;
  }

  .title-container {
    gap: 1rem;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 5dvh;
  }

  .timeline {
    position: relative;
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
  }

  .timeline::before {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 2px;
    height: 100%;
    background-color: var(--accent-regular);
  }

  .timeline-item {
    position: relative;
    margin-bottom: 3rem;
    opacity: 0;
    transform: translateX(100px);
  }

  .timeline-point {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 20px;
    height: 20px;
    background-color: var(--accent-regular);
    border-radius: 50%;
  }

  .timeline-content {
    position: relative;
    width: calc(50% - 50px);
    margin-left: calc(50% + 50px);
    background: var(--gray-999);
    padding: 1.5rem;
    border-radius: 8px;
  }

  /* Add this new style for odd-numbered items */
  .timeline-item:nth-child(odd) .timeline-content {
    margin-left: 0;
    margin-right: calc(50% + 50px);
    text-align: right;
  }

  .timeline-content h5 {
    font-size: var(--text-lg);
    margin-bottom: 0.5rem;
  }

  .timeline-content p {
    color: var(--gray-400);
  }

  @media (max-width: 1500px) {
    .timeline::before {
      left: 30px;
    }
    
    .timeline-point {
      left: 30px;
      transform: translateX(0);
    }
    
    .timeline-content {
      width: calc(100% - 90px);
      margin-left: 90px;
    }

    /* Reset the odd items styling for mobile view */
    .timeline-item:nth-child(odd) .timeline-content {
      margin-left: 90px;
      margin-right: 0;
      text-align: left;
    }
    
    .timeline-item {
      transform: translateY(50px);
    }
  }

  @media (min-width: 50em) {
    .box {
      border-radius: 1.5rem;
      padding: 2.5rem;
    }
  }
</style>